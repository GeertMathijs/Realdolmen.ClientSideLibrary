"use strict";var RD=window.RD||{_namespace:!0};RD.Libraries=RD.Libraries||{_namespace:!0};RD.Libraries.BL=RD.Libraries.BL||{_namespace:!0},function(){this.ValidateVAT=function(n,t){var i=t;return(i.indexOf(".")!=-1&&(i=i.replace(/\./g,"")),i.substring(0,2).toUpperCase()==n&&(i=i.substring(2,i.length)),i.length!=10)?RD.Libraries.BL.GetError("BL003"):i.substring(0,1)!=0?RD.Libraries.BL.GetError("BL004"):97-i.slice(0,8)%97!=i.slice(8,10)?RD.Libraries.BL.GetError("BL001"):!0};this.ValidateRijksregister=function(n,t){var e=Xrm.Page.getAttribute(n),i,o;if(e!=null){if(i=e.getValue(),i=i.replace(/[^a-zA-Z0-9 ]/g,""),i.length!=11)return RD.Libraries.BL.GetError("BL006");var r=!1,u=null,f=i;return(t!=null&&(u=Xrm.Page.getAttribute(t)),u!=null&&u.getValue()!=null?(o=u.getValue(),r=o.getFullYear()<2e3?this.SocialSecurityCheckSum(f):this.SocialSecurityCheckSum("2"+f)):(r=this.SocialSecurityCheckSum(f),r||(r=this.SocialSecurityCheckSum("2"+f))),!r)?RD.Libraries.BL.GetError("BL006"):!0}};this.SocialSecurityCheckSum=function(n){var t=n.substr(n.length-2,n.length),i=n.substr(0,n.length-2);return 97-i%97==t?!0:!1};this.GetError=function(n){var i=Xrm.Page.context.getUserLcid(),t="";try{t={BL001:{1031:"UID ist ungültig.",1033:"VAT number is invalid.",1036:"Numéro de TVA est invalide.",1043:"BTW-nummer is ongeldig."},BL002:{1031:"Online UID validierung fehlgeschlagen.",1033:"Online VAT number validation failed.",1036:"Numéro de TVA de validation en ligne a échoué.",1043:"Online BTW-nummer validatie is mislukt."},BL003:{1031:"UID muss Länge von 10 haben.",1033:"VAT number must have length 10.",1036:"Numéro de TVA doit avoir une longueur de 10.",1043:"BTW-nummer moet lengte 10 hebben."},BL004:{1031:"UID muss mit einer 0 beginnen.",1033:"VAT number must start with a 0.",1036:"Numéro de TVA doit commencer par un 0.",1043:"BTW-nummer moet met een 0 beginnen."},BL005:{1031:"Sozialversicherungsnummer muss Länge von 10 haben.",1033:"Social Security number must have length 11.",1036:"Numéro de Sécurité Sociale doit avoir une longueur de 11.",1043:"Rijksregister nummer moet lengte 11 hebben."},BL006:{1031:"Sozialversicherungsnummer ist ungültig.",1033:"Invalid social security number.",1036:"Numéro de Sécurité Sociale est invalide.",1043:"Rijksregister nummer is ongeldig."}}[n];t=t[i]}catch(r){t="An Error has occurred, please contact your system administrator";n="BL000"}return{ERROR:t,ERRORCODE:n}}}.call(RD.Libraries.BL);
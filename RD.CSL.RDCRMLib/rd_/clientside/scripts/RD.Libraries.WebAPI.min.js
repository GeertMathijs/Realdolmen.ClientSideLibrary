"use strict";var RD=window.RD||{__namespace:!0};RD.Libraries=RD.Libraries||{__namespace:!0};RD.Libraries.WebAPI=RD.Libraries.WebAPI||{__namespace:!0},function(){function u(n,t){var r=n.filterOperator?n.filterOperator:"and",i="";return n.conditions.forEach(function(n){if(i.length>0&&(i=i+" "+r),h.indexOf(n.operator)>=0)i=i+" "+n.operator+"("+n.attribute+",'"+n.value+"')";else if(c.indexOf(n.operator)>=0)if(n.value)i=i+" Microsoft.Dynamics.CRM."+n.operator+"(PropertyName='"+n.attribute+"',PropertyValue='"+n.value+"')";else if(n.values){var t="";n.values.forEach(function(){t.length>0&&(t=t+",");t=t+'"'+t+'"'});i=i+" Microsoft.Dynamics.CRM."+n.operator+"(PropertyName='"+n.attribute+"',PropertyValues=["+t+"])"}else i=i+" Microsoft.Dynamics.CRM."+n.operator+"(PropertyName='"+n.attribute+"')";else n.value&&(i=isNaN(n.value)?i+" "+n.attribute+" "+n.operator+" '"+n.value+"'":i+" "+n.attribute+" "+n.operator+" "+n.value)}),t=t+"("+i+")",n.filters&&n.filters.forEach(function(n){t=u(n,t)}),t}function i(n,t,i){var u,r,f;n.status==200?(u=JSON.parse(n.response),typeof u["@odata.count"]!="undefined"?t(u["@odata.count"]):t(u)):n.status==204?(r=n.getResponseHeader("odata-entityid"),r?(r=r.substring(r.indexOf("(")+1).substring(0,36),t(r)):t()):(f=JSON.parse(n.response).error,i(f))}function e(){if(typeof GetGlobalContext=="function"&&typeof GetGlobalContext().getClientUrl=="function")return GetGlobalContext().getClientUrl();if(typeof Xrm!="undefined"&&typeof Xrm.Page!="undefined"&&typeof Xrm.Page.context!="undefined"&&typeof Xrm.Page.context.getClientUrl=="function")try{return Xrm.Page.context.getClientUrl()}catch(n){throw new Error("Xrm.Page.context.getClientUrl is not available.");}else throw new Error("Context is not available.");}function r(){return e()+"/api/data/v8.0/"}function f(n){return n===null?!0:!1}function o(n){return typeof n=="undefined"?!0:!1}function s(n){return typeof n=="function"?!0:!1}function n(n){return f(n)||o(n)?!0:!1}function t(n){return f(n)?!0:s(n)?!0:!1}this.create=function(u,f,e){if(n(u))throw new Error("RD.WebAPI.create entity parameter must not be null or undefined.");if(!t(f))throw new Error("RD.WebAPI.create successCallBack parameter must be a function or null.");if(!t(e))throw new Error("RD.WebAPI.create errorCallBack parameter must be a function or null.");if(n(u.logicalName))throw new Error("entity parameter must contain a logicalName");if(n(u.attributes))throw new Error("entity parameter must contain attributes");var s=u.logicalName+"s",o=new XMLHttpRequest;o.open("POST",encodeURI(r()+s),!0);o.setRequestHeader("Accept","application/json");o.setRequestHeader("Content-Type","application/json; charset=utf-8");o.setRequestHeader("OData-MaxVersion","4.0");o.setRequestHeader("OData-Version","4.0");o.onreadystatechange=function(){this.readyState==4&&(o.onreadystatechange=null,i(this,f,e))};o.send(JSON.stringify(u.attributes))};this.update=function(u,f,e){if(n(u))throw new Error("RD.WebAPI.update entity parameter must not be null or undefined.");if(!t(f))throw new Error("RD.WebAPI.update successCallBack parameter must be a function or null.");if(!t(e))throw new Error("RD.WebAPI.update errorCallBack parameter must be a function or null.");if(n(u.logicalName))throw new Error("entity parameter must contain a logicalName");if(n(u.attributes))throw new Error("entity parameter must contain attributes");var s=u.logicalName+"s",h=u.id.replace("{","").replace("}",""),c=s+"("+h+")",o=new XMLHttpRequest;o.open("PATCH",encodeURI(r()+c),!0);o.setRequestHeader("Accept","application/json");o.setRequestHeader("Content-Type","application/json; charset=utf-8");o.setRequestHeader("OData-MaxVersion","4.0");o.setRequestHeader("OData-Version","4.0");o.setRequestHeader("Prefer",'odata.include-annotations="*"');o.onreadystatechange=function(){this.readyState==4&&(o.onreadystatechange=null,i(this,f,e))};o.send(JSON.stringify(u.attributes))};this.retrieve=function(u,f,e,o,s){var v,h,y;if(n(u))throw new Error("RD.WebAPI.retrieve logicalName parameter must not be null or undefined.");if(n(f))throw new Error("RD.WebAPI.retrieve id parameter must not be null or undefined.");if(n(e))throw new Error("RD.WebAPI.retrieve columnset parameter must not be null or undefined.");if(!t(o))throw new Error("RD.WebAPI.retrieve successCallBack parameter must be a function or null.");if(!t(s))throw new Error("RD.WebAPI.retrieve errorCallBack parameter must be a function or null.");u=u+"s";f=f.replace("{","").replace("}","");var c="",l="",a=[];e===!0?c="*":e.forEach(function(n){if(n.indexOf(".")<0)c.length>0&&(c=c+", "),c=c+n;else{var t=n.split(".");a[t[0]]=a[t[0]]?a[t[0]]+", "+t[1]:t[1]}});for(v in a)typeof a[v]!="function"&&(l.length>0&&(l=l+", "),l=l+v+"($select="+a[v]+")");h=new XMLHttpRequest;y=u+"("+f+")?$select="+c;l!=""&&(y=y+"&$expand="+l);h.open("GET",encodeURI(r()+y),!0);h.setRequestHeader("Accept","application/json");h.setRequestHeader("Content-Type","application/json; charset=utf-8");h.setRequestHeader("OData-MaxVersion","4.0");h.setRequestHeader("OData-Version","4.0");h.setRequestHeader("Prefer",'odata.include-annotations="*"');h.onreadystatechange=function(){this.readyState==4&&(h.onreadystatechange=null,i(this,o,s))};h.send()};this.retrieveMultiple=function(f,e,o){var y,s,a;if(n(f))throw new Error("RD.WebAPI.retrieveMultiple query parameter must not be null or undefined.");if(!t(e))throw new Error("RD.WebAPI.retrieveMultiple successCallBack parameter must be a function or null.");if(!t(o))throw new Error("RD.WebAPI.retrieveMultiple errorCallBack parameter must be a function or null.");if(n(f.logicalName))throw new Error("query should contain a logicalName.");if(n(f.columnset))throw new Error("query should contain a columnset (array of strings).");if(n(f.filters))throw new Error("query should contain a filters (array of filters).");logicalName=f.logicalName+"s";var h="",c="",v="",l=[];f.columnset===!0?h="*":f.columnset.forEach(function(n){if(n.indexOf(".")<0)h.length>0&&(h=h+", "),h=h+n;else{var t=n.split(".");l[t[0]]=l[t[0]]?l[t[0]]+", "+t[1]:t[1]}});f.filters.forEach(function(n){v=u(n,v)});for(y in l)typeof l[y]!="function"&&(c.length>0&&(c=c+", "),c=c+y+"($select="+l[y]+")");s=new XMLHttpRequest;a=logicalName+"?$select="+h;c!=""&&(a=a+"&$expand="+c);v!=""&&(a=a+"&$filter="+v);s.open("GET",encodeURI(r()+a),!0);s.setRequestHeader("Accept","application/json");s.setRequestHeader("Content-Type","application/json; charset=utf-8");s.setRequestHeader("OData-MaxVersion","4.0");s.setRequestHeader("OData-Version","4.0");s.setRequestHeader("Prefer",'odata.include-annotations="*"');s.onreadystatechange=function(){this.readyState==4&&(s.onreadystatechange=null,i(this,e,o))};s.send()};this.count=function(f,e,o){var h,s,c;if(n(f))throw new Error("RD.WebAPI.count query parameter must not be null or undefined.");if(!t(e))throw new Error("RD.WebAPI.count successCallBack parameter must be a function or null.");if(!t(o))throw new Error("RD.WebAPI.count errorCallBack parameter must be a function or null.");if(n(f.logicalName))throw new Error("query should contain a logicalName.");if(n(f.filters))throw new Error("query should contain a columnset (array of filters).");logicalName=f.logicalName+"s";h="";f.filters.forEach(function(n){h=u(n,h)});s=new XMLHttpRequest;c=logicalName+"?$count=true";h!=""&&(c=c+"&$filter="+h);s.open("GET",encodeURI(r()+c),!0);s.setRequestHeader("Accept","application/json");s.setRequestHeader("Content-Type","application/json; charset=utf-8");s.setRequestHeader("OData-MaxVersion","4.0");s.setRequestHeader("OData-Version","4.0");s.setRequestHeader("Prefer",'odata.include-annotations="*"');s.onreadystatechange=function(){this.readyState==4&&(s.onreadystatechange=null,i(this,e,o))};s.send()};this["delete"]=function(u,f,e,o){if(n(u))throw new Error("RD.WebAPI.delete logicalName parameter must not be null or undefined.");if(n(f))throw new Error("RD.WebAPI.delete id parameter must not be null or undefined.");if(!t(e))throw new Error("RD.WebAPI.delete successCallBack parameter must be a function or null.");if(!t(o))throw new Error("RD.WebAPI.delete errorCallBack parameter must be a function or null.");var h=u+"s("+f+")",s=new XMLHttpRequest;s.open("DELETE",encodeURI(r()+h),!0);s.setRequestHeader("Accept","application/json");s.setRequestHeader("Content-Type","application/json; charset=utf-8");s.setRequestHeader("OData-MaxVersion","4.0");s.setRequestHeader("OData-Version","4.0");s.onreadystatechange=function(){this.readyState==4&&(s.onreadystatechange=null,i(this,e,o))};s.send()};this.executeSavedQuery=function(u,f,e,o,s){if(n(u))throw new Error("RD.WebAPI.executeSavedQuery logicalName parameter must not be null or undefined.");if(n(f))throw new Error("RD.WebAPI.executeSavedQuery queryId parameter must not be null or undefined.");if(!t(o))throw new Error("RD.WebAPI.executeSavedQuery successCallBack parameter must be a function or null.");if(!t(s))throw new Error("RD.WebAPI.executeSavedQuery errorCallBack parameter must be a function or null.");n(e)&&(e="savedQuery");u=u+"s";var c=u+"?"+e+"="+f,h=new XMLHttpRequest;h.open("GET",encodeURI(r()+c),!0);h.setRequestHeader("Accept","application/json");h.setRequestHeader("Content-Type","application/json; charset=utf-8");h.setRequestHeader("OData-MaxVersion","4.0");h.setRequestHeader("OData-Version","4.0");h.setRequestHeader("Prefer",'odata.include-annotations="*"');h.onreadystatechange=function(){this.readyState==4&&(h.onreadystatechange=null,i(this,o,s))};h.send()};this.executeFetch=function(u,f,e,o){if(n(u))throw new Error("RD.WebAPI.executeFetch logicalName parameter must not be null or undefined.");if(n(f))throw new Error("RD.WebAPI.executeFetch fetchXml parameter must not be null or undefined.");if(!t(e))throw new Error("RD.WebAPI.executeFetch successCallBack parameter must be a function or null.");if(!t(o))throw new Error("RD.WebAPI.executeFetch errorCallBack parameter must be a function or null.");u=u+"s";var h=u+"?fetchXml="+f,s=new XMLHttpRequest;s.open("GET",encodeURI(r()+h),!0);s.setRequestHeader("Accept","application/json");s.setRequestHeader("Content-Type","application/json; charset=utf-8");s.setRequestHeader("OData-MaxVersion","4.0");s.setRequestHeader("OData-Version","4.0");s.setRequestHeader("Prefer",'odata.include-annotations="*"');s.onreadystatechange=function(){this.readyState==4&&(s.onreadystatechange=null,i(this,e,o))};s.send()};this.executeCustomAction=function(u,f,e,o){if(n(u))throw new Error("RD.WebAPI.executeFetch actionName parameter must not be null or undefined.");if(!t(e))throw new Error("RD.WebAPI.executeFetch successCallBack parameter must be a function or null.");if(!t(o))throw new Error("RD.WebAPI.executeFetch errorCallBack parameter must be a function or null.");n(f)&&(f={});var s=new XMLHttpRequest;s.open("POST",encodeURI(r()+u),!0);s.setRequestHeader("Accept","application/json");s.setRequestHeader("Content-Type","application/json; charset=utf-8");s.setRequestHeader("OData-MaxVersion","4.0");s.setRequestHeader("OData-Version","4.0");s.onreadystatechange=function(){this.readyState==4&&(s.onreadystatechange=null,i(this,e,o))};s.send(JSON.stringify(f))};this.dateReviver=function(n,t){var i;return typeof t=="string"&&(i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t),i)?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6])):t};this.errorHandler=function(n){try{return JSON.parse(n).error}catch(t){return new Error("Unexpected Error")}};var h=["contains","endswith","startswith"],c=["Above","AboveOrEqual","Between","Contains","EqualBusinessId","EqualUserId","EqualUserLanguage","EqualUserOrUserHierarchy","EqualUserOrUserHierarchyAndTeams","EqualUserOrUserTeams","EqualUserTeams","In","InFiscalPeriod","InFiscalPeriodAndYear","InFiscalYear","InOrAfterFiscalPeriodAndYear","InOrBeforeFiscalPeriodAndYear","Last7Days","LastFiscalPeriod","LastFiscalYear","LastMonth","LastWeek","LastXDays","LastXFiscalPeriods","LastXFiscalYears","LastXHours","LastXMonths","LastXWeeks","LastXYears","LastYear","Next7Days","NextFiscalPeriod","NextFiscalYear","NextMonth","NextWeek","NextXDays","NextXFiscalPeriods","NextXFiscalYears","NextXHours","NextXMonths","NextXWeeks","NextXYears","NextYear","NotBetween","NotEqualBusinessId","NotEqualUserId","NotIn","NotUnder","OlderThanXDays","OlderThanXHours","OlderThanXMinutes","OlderThanXMonths","OlderThanXWeeks","OlderThanXYears","On","OnOrAfter","OnOrBefore","ThisFiscalPeriod","ThisFiscalYear","ThisMonth","ThisWeek","ThisYear","Today","Tomorrow","Under","UnderOrEqual","Yesterday"]}.call(RD.Libraries.WebAPI);